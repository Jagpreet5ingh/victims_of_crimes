URL of chat history: https://chat.openai.com/share/ca1dffc9-383d-4ca5-9d77-ab338a2eb65b

library("tidyverse")
crime_data <- read_csv("output/data/edited_data.csv",show_col_types = FALSE) 
column_specifications <- spec(crime_data)

total_counts <- aggregate(COUNT_ ~ REPORT_YEAR, data = crime_data, sum)  
# Create a bar graph using ggplot2 
ggplot(total_counts, aes(x = as.factor(REPORT_YEAR), y = COUNT_)) +   
  geom_bar(stat = "identity", fill = "blue", alpha = 0.7) + 
   geom_line(aes(group = 1), stat = "smooth", method = "lm", se = FALSE, color = "red", linetype = "solid") +  # Add trendline
  labs(title = "Total Counts of Crimes Against the Person in an Year (2014-2022)",      
       x = "Year",        
       y = "Total Number of Crimes") +  
  scale_y_continuous(breaks = seq(0, max(total_counts$COUNT_), by = 2000)) + # Set y-axis breaks
  theme_minimal()
---------------------------- create a table with two columns: Year(using Report_Year) and Total number of crimes (using Count_)
ChatGPT
To create a table with two columns, "Year" (using REPORT_YEAR) and "Total number of crimes" (using COUNT_), you can use the data.frame function. Here's an example of how you can do that:

R
Copy code
# Calculate total counts
total_counts <- aggregate(COUNT_ ~ REPORT_YEAR, data = crime_data, sum)

# Create a data frame for the table
crime_table <- data.frame(Year = total_counts$REPORT_YEAR, Total_Number_of_Crimes = total_counts$COUNT_)

# Print the table
print(crime_table)
This will create a data frame (crime_table) with two columns, "Year" and "Total_Number_of_Crimes", and print the table. You can further customize the table or save it as a CSV file if needed.